{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { WPCEdit } from 'wpcedit';\nexport const useWpcEditStore = defineStore('wpcEditStore', {\n  state: () => {\n    return {\n      romIsLoaded: false,\n      romIsAltered: false,\n      viewTitle: 'WPC Edit',\n      fileName: '',\n      isAtHomeView: true,\n      currSpriteIndex: 0,\n      currSpriteTableIndex: 0,\n      currentRomData: null,\n      spriteTableMap: null\n    };\n  },\n  getters: {\n    maxFullFrameIndex: state => {\n      /*\n      let index = 900;//WPCEdit.fullFrameImage.maxImageIndex;\n      let invalidImages = 0;\n      while(invalidImages<4 && index<2000) {\n          const plane = WPCEdit.fullFrameImage.getPlaneAt(index);\n          if(plane.type > 11 && plane.type != 255) {\n              invalidImages++;\n              console.log(\"INVALID at index: \"+index);\n          }\n          index++;\n      }\n      \n      //console.log(\"type: \"+plane.type);\n           console.log(\"max: \"+index)\n      return index;*/\n      console.log(state);\n      return 1000;\n    },\n    storedChecksum: () => {\n      return WPCEdit.checksum.stored.toString(16).toUpperCase();\n    },\n    calculatedChecksum: () => {\n      return WPCEdit.checksum.calculated.toString(16).toUpperCase();\n    },\n    fixupBytes: () => {\n      return WPCEdit.checksum.delta.toString(16).toUpperCase();\n    },\n    versionByte: () => {\n      return (WPCEdit.checksum.stored & 0xFF).toString(16);\n    },\n    checksumIsValid: () => {\n      return WPCEdit.checksum.isValid;\n    }\n  },\n  actions: {\n    loadRom(data, name) {\n      WPCEdit.init();\n      //WPCEdit.setRom(data)\n      if (WPCEdit.setRom(data)) {\n        this.fileName = name;\n        this.romIsLoaded = true;\n        this.currentRomData = data;\n        this.spriteTableMap = WPCEdit.variableSizedImage.indexMap;\n        WPCEdit.verbose = true;\n      }\n    },\n    getFullFrameImageAt(index) {\n      return WPCEdit.fullFrameImage.getPlaneAt(index);\n    },\n    getSpriteAt(table, index) {\n      WPCEdit.variableSizedImage.table = table;\n      WPCEdit.variableSizedImage.index = index;\n      return WPCEdit.variableSizedImage.plane;\n    },\n    getSpriteCentered(table, index) {\n      WPCEdit.variableSizedImage.table = table;\n      WPCEdit.variableSizedImage.index = index;\n      const spritePlane = WPCEdit.variableSizedImage.plane;\n      const xOffset = Math.floor((128 - spritePlane.width) / 2);\n      const yOffset = Math.floor((32 - spritePlane.height) / 2);\n      const sprite = WPCEdit.variableSizedImage.placeInFullFrame(WPCEdit.variableSizedImage.plane, xOffset, yOffset);\n      return sprite;\n    },\n    getSpriteAsFullFrame(sprite, posX, posY) {\n      return sprite = WPCEdit.variableSizedImage.placeInFullFrame(sprite, posX, posY);\n    },\n    mergeImages(img1, img2, mask) {\n      return WPCEdit.fullFrameImage.mergeImages(img1, img2, mask);\n    },\n    updateChecksum(version) {\n      const newRom = WPCEdit.checksum.update(version);\n      this.loadRom(newRom, this.fileName);\n      this.romIsAltered = true;\n    },\n    disableChecksum() {\n      const newRom = WPCEdit.checksum.disable;\n      this.loadRom(newRom, this.fileName);\n      this.romIsAltered = true;\n    }\n  }\n});","map":{"version":3,"names":["defineStore","WPCEdit","useWpcEditStore","state","romIsLoaded","romIsAltered","viewTitle","fileName","isAtHomeView","currSpriteIndex","currSpriteTableIndex","currentRomData","spriteTableMap","getters","maxFullFrameIndex","console","log","storedChecksum","checksum","stored","toString","toUpperCase","calculatedChecksum","calculated","fixupBytes","delta","versionByte","checksumIsValid","isValid","actions","loadRom","data","name","init","setRom","variableSizedImage","indexMap","verbose","getFullFrameImageAt","index","fullFrameImage","getPlaneAt","getSpriteAt","table","plane","getSpriteCentered","spritePlane","xOffset","Math","floor","width","yOffset","height","sprite","placeInFullFrame","getSpriteAsFullFrame","posX","posY","mergeImages","img1","img2","mask","updateChecksum","version","newRom","update","disableChecksum","disable"],"sources":["/Users/permartinson/Documents/GitHub/wpcedit-vue/src/stores/wpcEditStore.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { WPCEdit } from 'wpcedit';\n\nexport const useWpcEditStore = defineStore('wpcEditStore', {\n    state: () => {\n        return {\n            romIsLoaded: false,\n            romIsAltered: false,\n            viewTitle: 'WPC Edit',\n            fileName: '',\n            isAtHomeView: true,\n            currSpriteIndex: 0,\n            currSpriteTableIndex: 0,\n            currentRomData: null,\n            spriteTableMap: null\n        }\n    },\n    getters: {\n        maxFullFrameIndex: (state) => {\n            /*\n            let index = 900;//WPCEdit.fullFrameImage.maxImageIndex;\n            let invalidImages = 0;\n            while(invalidImages<4 && index<2000) {\n                const plane = WPCEdit.fullFrameImage.getPlaneAt(index);\n                if(plane.type > 11 && plane.type != 255) {\n                    invalidImages++;\n                    console.log(\"INVALID at index: \"+index);\n                }\n                index++;\n            }\n            \n            //console.log(\"type: \"+plane.type);\n    \n            console.log(\"max: \"+index)\n            return index;*/\n            console.log(state);\n            return 1000;\n        },\n        storedChecksum: () => {\n            return WPCEdit.checksum.stored.toString(16).toUpperCase();\n        },\n        calculatedChecksum: () => {\n            return WPCEdit.checksum.calculated.toString(16).toUpperCase();\n        },\n        fixupBytes: () => {\n            return WPCEdit.checksum.delta.toString(16).toUpperCase();\n        },\n        versionByte: () => {\n            return (WPCEdit.checksum.stored & 0xFF).toString(16);\n        },\n        checksumIsValid: () => {\n            return WPCEdit.checksum.isValid;\n        }\n    },\n    actions: {\n        loadRom(data,name) {\n            WPCEdit.init();\n            //WPCEdit.setRom(data)\n            if(WPCEdit.setRom(data)) {\n                this.fileName = name;\n                this.romIsLoaded = true;\n                this.currentRomData = data;\n                this.spriteTableMap = WPCEdit.variableSizedImage.indexMap;\n                WPCEdit.verbose = true;\n            }\n        },\n        getFullFrameImageAt(index) {\n            return WPCEdit.fullFrameImage.getPlaneAt(index);\n        },\n        getSpriteAt(table,index) {\n            WPCEdit.variableSizedImage.table = table;\n            WPCEdit.variableSizedImage.index = index;\n            return WPCEdit.variableSizedImage.plane;\n        },\n        getSpriteCentered(table,index) {\n            WPCEdit.variableSizedImage.table = table;\n            WPCEdit.variableSizedImage.index = index;\n            const spritePlane = WPCEdit.variableSizedImage.plane\n            const xOffset = Math.floor((128-spritePlane.width)/2);\n            const yOffset = Math.floor((32-spritePlane.height)/2);\n            const sprite = WPCEdit.variableSizedImage.placeInFullFrame(WPCEdit.variableSizedImage.plane,xOffset,yOffset)\n            return sprite;\n        },\n        getSpriteAsFullFrame(sprite,posX,posY) {\n            return sprite = WPCEdit.variableSizedImage.placeInFullFrame(sprite,posX,posY)\n        },\n        mergeImages(img1,img2,mask) {\n            return WPCEdit.fullFrameImage.mergeImages(img1,img2,mask);\n        },\n        updateChecksum(version) {\n            const newRom = WPCEdit.checksum.update(version);\n            this.loadRom(newRom,this.fileName);\n            this.romIsAltered = true;\n        },\n        disableChecksum() {\n            const newRom = WPCEdit.checksum.disable;\n            this.loadRom(newRom,this.fileName);\n            this.romIsAltered = true;\n        }\n    }\n})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}