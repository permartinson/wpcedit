{"ast":null,"code":"//import  { fabric }  from 'fabric';\nimport * as PIXI from 'pixi.js';\nexport default {\n  name: 'MainDmd',\n  props: {\n    plane0: Uint8Array,\n    plane1: Uint8Array,\n    shouldBlend: Boolean\n  },\n  methods: {\n    drawImage() {\n      if (this.shouldBlend) {\n        //this.drawBlendedImage(this.plane0,this.plane1);\n        this.drawRealisticImage(this.plane0, this.plane1);\n      } else {\n        console.log(this.plane0);\n        this.draw1bitImage(this.plane0);\n      }\n    },\n    drawBlendedImage(plane0Data, plane1Data) {\n      const canvas = document.querySelector(\"#canvas\");\n      let ctx = canvas.getContext(\"2d\");\n      let imageData = ctx.createImageData(128, 32);\n      let counter = 0;\n      for (let i = 0; i < imageData.data.length; i += 4) {\n        const color = this.bitToRGBRowsBlended(plane0Data, plane1Data, counter);\n        imageData.data[i] = color * 187 + 33;\n        imageData.data[i + 1] = color * 100 + 33;\n        imageData.data[i + 2] = 33; //color;\n        imageData.data[i + 3] = 255;\n        counter++;\n      }\n      console.log(plane0Data);\n      ctx.putImageData(imageData, 0, 0);\n    },\n    drawRealisticImage(plane0Data, plane1Data) {\n      var renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight, {\n        backgroundColor: 0xffffff,\n        resolution: 2\n      });\n      const planedata = [plane0Data, plane1Data];\n      console.log(planedata);\n\n      // add viewport and fix resolution doubling\n      document.body.appendChild(renderer.view);\n      renderer.view.style.width = \"100%\";\n      renderer.view.style.height = \"100%\";\n      var stage = new PIXI.Container();\n      const dotPath = require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n      var texture = PIXI.Texture.fromImage('https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Gear_icon_svg.svg/2000px-Gear_icon_svg.svg.png');\n      var gear = new PIXI.Sprite(texture);\n      //position and scale\n\n      gear.position = {\n        x: window.innerWidth / 2,\n        y: window.innerHeight / 2\n      };\n      gear.anchor = {\n        x: 0.5,\n        y: 0.5\n      };\n      stage.addChild(gear);\n\n      /*\n      var canvas = new fabric.Canvas('canvas');\n      var group = [];\n      const planedata = [plane0Data,plane1Data]\n      console.log(planedata);\n      const dotPath = require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n      fabric.loadSVGFromURL(dotPath,function() {\n          for(let i=0; i<plane0Data.length; i++) {\n              const loadedObjects = new fabric.Group(group);\n              //let color = 1//this.bitToRGBRows(plane0Data,i);\n              const xPos = (i%128)*8;\n              const yPos = (i/32)*8;\n              //if(color == 1) {\n                  loadedObjects.set({\n                      left: xPos,\n                      top: yPos,\n                      width:8,\n                      height:8\n                  });\n                  canvas.add(loadedObjects);\n              //}\n          }\n          canvas.renderAll();\n      },function(item, object) {\n              object.set('id',item.getAttribute('id'));\n              group.push(object);\n      });\n      */\n    },\n\n    draw1bitImage(plane0Data) {\n      const canvas = document.querySelector(\"#canvas\");\n      let ctx = canvas.getContext(\"2d\");\n      let imageData = ctx.createImageData(128, 32);\n      let counter = 0;\n      for (let i = 0; i < imageData.data.length; i += 4) {\n        let color = this.bitToRGBRows(plane0Data, counter);\n        //if(plane1Data != null) {\n        //    color = bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n        //}\n        imageData.data[i] = color * 187 + 33;\n        imageData.data[i + 1] = color * 100 + 33;\n        imageData.data[i + 2] = 33; //color;\n        imageData.data[i + 3] = 255;\n        counter++;\n      }\n      console.log(plane0Data);\n      ctx.putImageData(imageData, 0, 0);\n    },\n    bitToRGBRows(planeData, index) {\n      const width = 128;\n      const col = index % width;\n      const byte = Math.floor(index / 8);\n      const bitPos = col % 8;\n      const bit = (planeData[byte] & 0xFF) >> bitPos & 1;\n      return bit;\n    },\n    bitToRGBRowsBlended(plane0Data, plane1Data, index) {\n      const width = 128;\n      const col = index % width;\n      const byte = Math.floor(index / 8);\n      const bitPos = col % 8;\n      const plane0Bit = (plane0Data[byte] & 0xFF) >> bitPos & 1;\n      const plane1Bit = (plane1Data[byte] & 0xFF) >> bitPos & 1;\n      let colorVal = plane0Bit * 0.67 + plane1Bit * 0.33;\n      return colorVal;\n    }\n  },\n  mounted() {\n    this.drawImage();\n  }\n};","map":{"version":3,"mappings":"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","names":["PIXI","name","props","plane0","Uint8Array","plane1","shouldBlend","Boolean","methods","drawImage","drawRealisticImage","console","log","draw1bitImage","drawBlendedImage","plane0Data","plane1Data","canvas","document","querySelector","ctx","getContext","imageData","createImageData","counter","i","data","length","color","bitToRGBRowsBlended","putImageData","renderer","autoDetectRenderer","window","innerWidth","innerHeight","backgroundColor","resolution","planedata","body","appendChild","view","style","width","height","stage","Container","dotPath","require","texture","Texture","fromImage","gear","Sprite","position","x","y","anchor","addChild","bitToRGBRows","planeData","index","col","byte","Math","floor","bitPos","bit","plane0Bit","plane1Bit","colorVal","mounted"],"sourceRoot":"","sources":["/Users/permartinson/Documents/GitHub/wpcedit-vue/src/components/dmd/MainDmd.vue"],"sourcesContent":["<template>\n    <canvas id=\"canvas\" width=\"1024\" height=\"256\" class=\"dmd-canvas-main\"></canvas>\n</template>\n\n<script>\n//import  { fabric }  from 'fabric';\nimport * as PIXI from 'pixi.js';\n\nexport default {\n  name: 'MainDmd',\n  props: {\n    plane0: Uint8Array,\n    plane1: Uint8Array,\n    shouldBlend: Boolean\n  },\n  methods: {\n    drawImage() {\n        if(this.shouldBlend) {\n            //this.drawBlendedImage(this.plane0,this.plane1);\n            this.drawRealisticImage(this.plane0,this.plane1);\n        } else {\n            console.log(this.plane0);\n            this.draw1bitImage(this.plane0);\n        }\n    },\n    drawBlendedImage(plane0Data,plane1Data) {\n        const canvas = document.querySelector(\"#canvas\");\n        let ctx = canvas.getContext(\"2d\");\n        let imageData = ctx.createImageData(128,32);\n        let counter = 0;\n        for(let i=0; i<imageData.data.length; i += 4) {\n            const color = this.bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n            imageData.data[i] = color*187 +33;\n            imageData.data[i+1] = color*100 +33;\n            imageData.data[i+2] = 33;//color;\n            imageData.data[i+3] = 255;\n            counter++;\n        }\n        console.log(plane0Data);\n        ctx.putImageData(imageData,0,0);\n    },\n    drawRealisticImage(plane0Data,plane1Data) {\n        var renderer = PIXI.autoDetectRenderer(\n    window.innerWidth, \n    window.innerHeight, \n    {\n        backgroundColor : 0xffffff,\n        resolution:2\n    }\n);\nconst planedata = [plane0Data,plane1Data]\n        console.log(planedata);\n\n// add viewport and fix resolution doubling\ndocument.body.appendChild(renderer.view);\nrenderer.view.style.width = \"100%\";\nrenderer.view.style.height = \"100%\";\n\nvar stage = new PIXI.Container();\n\nconst dotPath = require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n\nvar texture = PIXI.Texture.fromImage('https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Gear_icon_svg.svg/2000px-Gear_icon_svg.svg.png');\nvar gear = new PIXI.Sprite(texture);\n//position and scale\n\ngear.position = {x:window.innerWidth / 2,y:window.innerHeight / 2};\ngear.anchor = {x:0.5,y:0.5};\nstage.addChild(gear);\n\n        /*\n        var canvas = new fabric.Canvas('canvas');\n        var group = [];\n        const planedata = [plane0Data,plane1Data]\n        console.log(planedata);\n        const dotPath = require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n        fabric.loadSVGFromURL(dotPath,function() {\n            for(let i=0; i<plane0Data.length; i++) {\n                const loadedObjects = new fabric.Group(group);\n                //let color = 1//this.bitToRGBRows(plane0Data,i);\n                const xPos = (i%128)*8;\n                const yPos = (i/32)*8;\n                //if(color == 1) {\n                    loadedObjects.set({\n                        left: xPos,\n                        top: yPos,\n                        width:8,\n                        height:8\n                    });\n                    canvas.add(loadedObjects);\n                //}\n            }\n            canvas.renderAll();\n        },function(item, object) {\n                object.set('id',item.getAttribute('id'));\n                group.push(object);\n        });\n        */\n    },\n    draw1bitImage(plane0Data) {\n        const canvas = document.querySelector(\"#canvas\");\n        let ctx = canvas.getContext(\"2d\");\n        let imageData = ctx.createImageData(128,32);\n        let counter = 0;\n        for(let i=0; i<imageData.data.length; i += 4) {\n            let color = this.bitToRGBRows(plane0Data,counter);\n            //if(plane1Data != null) {\n            //    color = bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n            //}\n            imageData.data[i] = color*187 +33;\n            imageData.data[i+1] = color*100 +33;\n            imageData.data[i+2] = 33;//color;\n            imageData.data[i+3] = 255;\n            counter++;\n        }\n        console.log(plane0Data);\n        ctx.putImageData(imageData,0,0);\n    },\n    bitToRGBRows(planeData,index) {\n        const width = 128;\n        const col = index % width;\n        const byte = Math.floor(index/8);\n        const bitPos = (col % 8);\n        const bit =  ( planeData[byte] & 0xFF ) >>(bitPos) & 1;\n        return bit;\n    },\n    bitToRGBRowsBlended(plane0Data,plane1Data,index) {\n        const width = 128;\n        const col = index % width;\n        const byte = Math.floor(index/8);\n        const bitPos = (col % 8);\n        const plane0Bit =  ( plane0Data[byte] & 0xFF ) >>(bitPos) & 1;\n        const plane1Bit =  ( plane1Data[byte] & 0xFF ) >>(bitPos) & 1;\n        let colorVal = plane0Bit * 0.67 + plane1Bit * 0.33;\n        return colorVal;\n    }\n  },\n  mounted() {\n    this.drawImage();\n  }\n}\n\n</script>\n\n<style scoped>\n\n#canvas {\n    position: absolute;\n    top:100px;\n    margin-top: 100px;\n}\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}