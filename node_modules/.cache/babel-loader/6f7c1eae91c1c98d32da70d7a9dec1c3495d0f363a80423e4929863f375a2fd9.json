{"ast":null,"code":"//import  { fabric }  from 'fabric';\nimport * as PIXI from 'pixi.js';\nimport { AdvancedBloomFilter } from '@pixi/filter-advanced-bloom';\nimport { AdjustmentFilter } from '@pixi/filter-adjustment';\nexport default {\n  name: 'MainDmd',\n  props: {\n    plane0: Uint8Array,\n    plane1: Uint8Array,\n    useBothPlanes: Boolean\n  },\n  data() {\n    return {\n      pixiApp: new PIXI.Application({\n        background: '#0C0C0C',\n        width: 1024 + 32,\n        height: 256 + 32,\n        view: document.querySelectorAll(\".dmd-canvas\")[0]\n      })\n    };\n  },\n  methods: {\n    drawImage() {\n      this.drawPlasmaStyle();\n    },\n    drawBlendedImage(plane0Data, plane1Data) {\n      const canvas = document.querySelector(\".dmd-canvas\")[0];\n      let ctx = canvas.getContext(\"2d\");\n      let imageData = ctx.createImageData(128, 32);\n      let counter = 0;\n      for (let i = 0; i < imageData.data.length; i += 4) {\n        const color = this.bitToRGBRowsBlended(plane0Data, plane1Data, counter);\n        imageData.data[i] = color * 187 + 33;\n        imageData.data[i + 1] = color * 100 + 33;\n        imageData.data[i + 2] = 33; //color;\n        imageData.data[i + 3] = 255;\n        counter++;\n      }\n      console.log(plane0Data);\n      ctx.putImageData(imageData, 0, 0);\n    },\n    drawPlasmaStyle() {\n      const DISPLAY_W = 1024;\n      const DISPLAY_H = 256;\n      const DOT_SIZE = 8;\n      const DISPLAY_MARGIN = 2 * DOT_SIZE;\n      const level0 = this.getDotTeture(0);\n      const level1 = this.getDotTeture(1);\n      const level2 = this.getDotTeture(2);\n      const level3 = this.getDotTeture(3);\n      const dmdDiv = document.querySelectorAll(\".dmd-container\")[0];\n      this.pixiApp.view.className = \"dmd-canvas\";\n      dmdDiv.appendChild(this.pixiApp.view);\n      const container = new PIXI.Container();\n      this.pixiApp.stage.addChild(container);\n      var graphics = new PIXI.Graphics();\n      graphics.beginFill(0xF0C0C0C);\n\n      // draw a background rectangle. this is to aviod a \"cropped\" look with the bloom effect\n      graphics.drawRect(0, 0, DISPLAY_W + 2 * DISPLAY_MARGIN, DISPLAY_H + 2 * DISPLAY_MARGIN);\n      graphics.zIndex = 1;\n      container.addChild(graphics);\n      const texture0 = PIXI.Texture.from(level0);\n      const texture1 = PIXI.Texture.from(level1);\n      const texture2 = PIXI.Texture.from(level2);\n      const texture3 = PIXI.Texture.from(level3);\n      for (let i = 0; i < 128 * 32; i++) {\n        let level = 0;\n        if (this.useBothPlanes) {\n          level = this.getDotLevelBlended(this.plane0, this.plane1, i);\n        } else {\n          level = this.getDotLevel(this.plane0, i);\n        }\n        let dot = new PIXI.Sprite(texture0);\n        if (level == 1) {\n          dot = new PIXI.Sprite(texture3);\n        } else if (level == 0.67) {\n          dot = new PIXI.Sprite(texture2);\n        } else if (level == 0.33) {\n          dot = new PIXI.Sprite(texture1);\n        }\n        dot.width = 8;\n        dot.height = 8;\n        dot.x = i % 128 * DOT_SIZE + DISPLAY_MARGIN;\n        dot.y = Math.floor(i / 128) * DOT_SIZE + DISPLAY_MARGIN;\n        dot.zIndex = 1000;\n        container.addChild(dot);\n      }\n      const blur = new PIXI.BlurFilter(1.5);\n      const bloom = new AdvancedBloomFilter({\n        blur: 2,\n        brightness: 1.2,\n        threshold: 0.15,\n        bloomScale: 0.3\n      });\n      const bloom2 = new AdvancedBloomFilter({\n        blur: 6,\n        brightness: 1,\n        threshold: 0.25,\n        bloomScale: 1\n      });\n      const adj = new AdjustmentFilter({\n        blue: 0.55,\n        green: 0.75,\n        gamma: 0.95\n      });\n      this.pixiApp.stage.filters = [blur, bloom, bloom2, adj];\n    },\n    draw1bitImage(plane0Data) {\n      const canvas = document.querySelector(\"#canvas\");\n      let ctx = canvas.getContext(\"2d\");\n      let imageData = ctx.createImageData(128, 32);\n      let counter = 0;\n      for (let i = 0; i < imageData.data.length; i += 4) {\n        let color = this.bitToRGBRows(plane0Data, counter);\n        //if(plane1Data != null) {\n        //    color = bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n        //}\n        imageData.data[i] = color * 187 + 33;\n        imageData.data[i + 1] = color * 100 + 33;\n        imageData.data[i + 2] = 33; //color;\n        imageData.data[i + 3] = 255;\n        counter++;\n      }\n      console.log(plane0Data);\n      ctx.putImageData(imageData, 0, 0);\n    },\n    getDotLevel(planeData, index) {\n      const width = 128;\n      const col = index % width;\n      const byte = Math.floor(index / 8);\n      const bitPos = col % 8;\n      const level = (planeData[byte] & 0xFF) >> bitPos & 1;\n      return level;\n    },\n    getDotLevelBlended(plane0Data, plane1Data, index) {\n      const width = 128;\n      const col = index % width;\n      const byte = Math.floor(index / 8);\n      const bitPos = col % 8;\n      const plane0Bit = (plane0Data[byte] & 0xFF) >> bitPos & 1;\n      const plane1Bit = (plane1Data[byte] & 0xFF) >> bitPos & 1;\n      let level = plane0Bit * 0.67 + plane1Bit * 0.33;\n      return level;\n    },\n    getDotTeture(level) {\n      switch (level) {\n        case 1:\n          return require('@/assets/graphics/dmd-sprites/plasma/1.svg');\n        case 2:\n          return require('@/assets/graphics/dmd-sprites/plasma/2.svg');\n        case 3:\n          return require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n        default:\n          return require('@/assets/graphics/dmd-sprites/plasma/0.svg');\n      }\n    }\n  },\n  mounted() {\n    this.drawImage();\n  },\n  beforeUpdate() {\n    this.pixiApp.destroy();\n  },\n  beforeUnmount() {\n    this.pixiApp.destroy();\n  }\n};","map":{"version":3,"mappings":"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","names":["PIXI","AdvancedBloomFilter","AdjustmentFilter","name","props","plane0","Uint8Array","plane1","useBothPlanes","Boolean","data","pixiApp","Application","background","width","height","view","document","querySelectorAll","methods","drawImage","drawPlasmaStyle","drawBlendedImage","plane0Data","plane1Data","canvas","querySelector","ctx","getContext","imageData","createImageData","counter","i","length","color","bitToRGBRowsBlended","console","log","putImageData","DISPLAY_W","DISPLAY_H","DOT_SIZE","DISPLAY_MARGIN","level0","getDotTeture","level1","level2","level3","dmdDiv","className","appendChild","container","Container","stage","addChild","graphics","Graphics","beginFill","drawRect","zIndex","texture0","Texture","from","texture1","texture2","texture3","level","getDotLevelBlended","getDotLevel","dot","Sprite","x","y","Math","floor","blur","BlurFilter","bloom","brightness","threshold","bloomScale","bloom2","adj","blue","green","gamma","filters","draw1bitImage","bitToRGBRows","planeData","index","col","byte","bitPos","plane0Bit","plane1Bit","require","mounted","beforeUpdate","destroy","beforeUnmount"],"sourceRoot":"","sources":["/Users/permartinson/Documents/GitHub/wpcedit-vue/src/components/dmd/MainDmd.vue"],"sourcesContent":["<template>\n    <div class=\"dmd-container\">\n        <canvas></canvas>\n    </div> \n</template>\n\n<script>\n//import  { fabric }  from 'fabric';\nimport * as PIXI from 'pixi.js';\nimport {AdvancedBloomFilter} from '@pixi/filter-advanced-bloom';\nimport {AdjustmentFilter} from '@pixi/filter-adjustment';\n\nexport default {\n  name: 'MainDmd',\n  props: {\n    plane0: Uint8Array,\n    plane1: Uint8Array,\n    useBothPlanes: Boolean\n  },\n  data() {\n    return {\n        pixiApp: new PIXI.Application({ background: '#0C0C0C', width: 1024+32, height: 256+32, view:document.querySelectorAll(\".dmd-canvas\")[0] }),\n    }\n  },\n  methods: {\n    drawImage() {\n        this.drawPlasmaStyle();\n    },\n    drawBlendedImage(plane0Data,plane1Data) {\n        const canvas = document.querySelector(\".dmd-canvas\")[0];\n        let ctx = canvas.getContext(\"2d\");\n        let imageData = ctx.createImageData(128,32);\n\n        \n        let counter = 0;\n        for(let i=0; i<imageData.data.length; i += 4) {\n            const color = this.bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n            imageData.data[i] = color*187 +33;\n            imageData.data[i+1] = color*100 +33;\n            imageData.data[i+2] = 33;//color;\n            imageData.data[i+3] = 255;\n            counter++;\n        }\n        console.log(plane0Data);\n        ctx.putImageData(imageData,0,0);\n    },\n    drawPlasmaStyle() {\n        const DISPLAY_W = 1024;\n        const DISPLAY_H = 256;\n        const DOT_SIZE = 8;\n        const DISPLAY_MARGIN = 2*DOT_SIZE;\n\n        const level0 = this.getDotTeture(0);\n        const level1 = this.getDotTeture(1);\n        const level2 = this.getDotTeture(2);\n        const level3 = this.getDotTeture(3);\n\n        const dmdDiv = document.querySelectorAll(\".dmd-container\")[0];\n        this.pixiApp.view.className = \"dmd-canvas\";\n        dmdDiv.appendChild(this.pixiApp.view);\n        const container = new PIXI.Container();\n        this.pixiApp.stage.addChild(container);\n        var graphics = new PIXI.Graphics();\n        graphics.beginFill(0xF0C0C0C);\n\n        // draw a background rectangle. this is to aviod a \"cropped\" look with the bloom effect\n        graphics.drawRect(0, 0, DISPLAY_W+2*DISPLAY_MARGIN, DISPLAY_H+2*DISPLAY_MARGIN);\n        graphics.zIndex = 1;\n\n        container.addChild(graphics);\n\n        const texture0 = PIXI.Texture.from(level0);\n        const texture1 = PIXI.Texture.from(level1);\n        const texture2 = PIXI.Texture.from(level2);\n        const texture3 = PIXI.Texture.from(level3);\n\n        for (let i = 0; i < 128*32; i++) {\n            let level = 0;\n            if(this.useBothPlanes) {\n                level = this.getDotLevelBlended(this.plane0,this.plane1,i);\n            } else {\n                level = this.getDotLevel(this.plane0,i);\n            }\n            let dot = new PIXI.Sprite(texture0);\n            if(level==1) {\n                dot = new PIXI.Sprite(texture3);\n            } else if(level==0.67) {\n                dot = new PIXI.Sprite(texture2);\n            } else if(level==0.33) {\n                dot = new PIXI.Sprite(texture1);\n            }\n            dot.width = 8;\n            dot.height = 8;\n            dot.x = (i % 128) * DOT_SIZE + DISPLAY_MARGIN;\n            dot.y = Math.floor(i / 128) * DOT_SIZE + DISPLAY_MARGIN;\n            dot.zIndex = 1000;\n            container.addChild(dot);\n        }\n        const blur = new PIXI.BlurFilter(1.5);\n        const bloom = new AdvancedBloomFilter({blur:2,brightness:1.2,threshold:0.15,bloomScale:0.3});\n        const bloom2 = new AdvancedBloomFilter({blur:6,brightness:1,threshold:0.25,bloomScale:1});\n        const adj = new AdjustmentFilter({blue:0.55,green:0.75,gamma:0.95});\n\n        this.pixiApp.stage.filters = [blur, bloom, bloom2, adj];\n    },\n    draw1bitImage(plane0Data) {\n        const canvas = document.querySelector(\"#canvas\");\n        let ctx = canvas.getContext(\"2d\");\n        let imageData = ctx.createImageData(128,32);\n        let counter = 0;\n        for(let i=0; i<imageData.data.length; i += 4) {\n            let color = this.bitToRGBRows(plane0Data,counter);\n            //if(plane1Data != null) {\n            //    color = bitToRGBRowsBlended(plane0Data,plane1Data,counter);\n            //}\n            imageData.data[i] = color*187 +33;\n            imageData.data[i+1] = color*100 +33;\n            imageData.data[i+2] = 33;//color;\n            imageData.data[i+3] = 255;\n            counter++;\n        }\n        console.log(plane0Data);\n        ctx.putImageData(imageData,0,0);\n    },\n    getDotLevel(planeData,index) {\n        const width = 128;\n        const col = index % width;\n        const byte = Math.floor(index/8);\n        const bitPos = (col % 8);\n        const level =  ( planeData[byte] & 0xFF ) >>(bitPos) & 1;\n        return level;\n    },\n    getDotLevelBlended(plane0Data,plane1Data,index) {\n        const width = 128;\n        const col = index % width;\n        const byte = Math.floor(index/8);\n        const bitPos = (col % 8);\n        const plane0Bit =  ( plane0Data[byte] & 0xFF ) >>(bitPos) & 1;\n        const plane1Bit =  ( plane1Data[byte] & 0xFF ) >>(bitPos) & 1;\n        let level = plane0Bit * 0.67 + plane1Bit * 0.33;\n        return level;\n    },\n    getDotTeture(level) {\n        switch(level){\n            case 1: \n                return require('@/assets/graphics/dmd-sprites/plasma/1.svg');\n            case 2: \n                return require('@/assets/graphics/dmd-sprites/plasma/2.svg');\n            case 3: \n                return require('@/assets/graphics/dmd-sprites/plasma/3.svg');\n            default:\n                return require('@/assets/graphics/dmd-sprites/plasma/0.svg');\n        }\n    }\n  },\n  mounted() {\n    this.drawImage();\n  },\n  beforeUpdate() {\n    this.pixiApp.destroy();\n  },\n  beforeUnmount() {\n    this.pixiApp.destroy();\n  }\n}\n\n</script>\n\n<style>\n\n.dmd-container {\n    margin-top: 100px;\n}\n\n.dmd-canvas {\n    width: 936px;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}