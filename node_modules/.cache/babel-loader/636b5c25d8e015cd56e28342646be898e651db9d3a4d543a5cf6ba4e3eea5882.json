{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport BaseModal from './BaseModal.vue';\nimport ModalHeader from './ModalHeader.vue';\nimport ModalFooter from './ModalFooter.vue';\nimport ExportSection from '../ExportSection.vue';\nimport MainDmd from '../../dmd/MainDmd.vue';\nimport SubDmd from '../../dmd/SubDmd.vue';\nimport OffsetControl from '../../ui/OffsetControl.vue';\nimport { toHex } from '../../../helpers/formatting.js';\nimport store from \"../../../stores/store.js\";\nimport { useWpcEditStore } from '../../../stores/wpcEditStore.js';\nconst WpcEditStore = useWpcEditStore(store);\nexport default {\n  name: 'SpriteModal',\n  components: {\n    BaseModal,\n    ModalHeader,\n    ModalFooter,\n    ExportSection,\n    MainDmd,\n    SubDmd,\n    OffsetControl\n  },\n  setup() {},\n  data() {\n    // fetch the selected export option and create an object to pass the data for the selector\n    const options = new Array();\n    const labels = ['PNG image from render', 'Monochrome BMP image', 'Monochrome BMP image (inverted)', 'Raw byte array, horizontal encoding'];\n    for (let i = 0; i < labels.length; i++) {\n      const selected = i == this.exportOption;\n      options.push({\n        value: i,\n        label: labels[i],\n        selected: selected\n      });\n    }\n    return {\n      doBlend: false,\n      offset: 0,\n      blendOffset: 1,\n      xOffset0: -1,\n      yOffset0: -1,\n      xOffset1: -1,\n      yOffset1: -1,\n      options\n    };\n  },\n  props: {\n    show: Boolean,\n    index: Number,\n    table: Number\n  },\n  computed: {\n    planeIndices() {\n      const currIndex = Math.max(this.index + this.offset, 0); // BUG! need to use the map as a reference here\n      return {\n        current: currIndex,\n        blend: Math.max(currIndex + this.blendOffset, 0)\n      };\n    },\n    currPlaneTitle() {\n      return `This sprite, index ${this.planeIndices.current}`;\n    },\n    blendPlaneLabel() {\n      return `Blend with index ${this.planeIndices.blend}`;\n    },\n    title() {\n      return `Image ${toHex(WpcEditStore.getSpriteAt(this.table, this.planeIndices.current).address, 6)}`;\n    }\n  },\n  methods: {\n    plane0() {\n      const indices = this.planeIndices;\n      const sprite = WpcEditStore.getSpriteAt(this.table, indices.current);\n      if (this.xOffset0 == -1 && this.yOffset0 == -1) {\n        this.xOffset0 = Math.floor((128 - sprite.width) / 2);\n        this.yOffset0 = Math.floor((32 - sprite.height) / 2);\n      }\n      return WpcEditStore.getSpriteAsFullFrame(sprite, this.xOffset0, this.yOffset0);\n    },\n    plane1() {\n      if (this.doBlend) {\n        return this.blendPlane();\n      }\n      return this.plane0();\n    },\n    blendPlane() {\n      const indices = this.planeIndices;\n      const sprite = WpcEditStore.getSpriteAt(this.table, indices.blend);\n      if (this.xOffset1 == -1 && this.yOffset1 == -1) {\n        this.xOffset1 = Math.floor((128 - sprite.width) / 2);\n        this.yOffset1 = Math.floor((32 - sprite.height) / 2);\n      }\n      return WpcEditStore.getSpriteAsFullFrame(sprite, this.xOffset1, this.yOffset1);\n    },\n    setBlendStatus(state) {\n      if (state == true) {\n        this.doBlend = true;\n      } else if (state == false) {\n        this.doBlend = false;\n      }\n    },\n    goToNextBlendPlane() {\n      this.blendOffset++;\n    },\n    goToPrevBlendPlane() {\n      this.blendOffset--;\n    },\n    goNext() {\n      this.offset++;\n      this.setInitValues();\n    },\n    goPrev() {\n      if (this.planeIndices.current > 0) {\n        this.offset--;\n      }\n      this.setInitValues();\n    },\n    goN2() {\n      this.offset += 2;\n      this.setInitValues();\n    },\n    goP2() {\n      if (this.planeIndices.current > 0) {\n        this.offset -= 2;\n      }\n      this.setInitValues();\n    },\n    moveSprite0X(amount) {\n      this.xOffset0 += amount;\n    },\n    moveSprite0Y(amount) {\n      this.yOffset0 += amount;\n    },\n    moveSprite1X(amount) {\n      this.xOffset1 += amount;\n    },\n    moveSprite1Y(amount) {\n      this.yOffset1 += amount;\n    },\n    setInitValues() {\n      // reset the values\n      this.blendOffset = 1;\n      this.xOffset0 = -1;\n      this.yOffset0 = -1;\n      this.xOffset1 = -1;\n      this.yOffset1 = -1;\n    },\n    exportCurrentSprite() {\n      if (this.exportOption == 0) {\n        this.$refs.main.downloadPng();\n      } else if (this.exportOption == 3) {\n        let dataString = WpcEditStore.exportAsDataArray(this.mainPlane());\n        if (this.doBlend) {\n          dataString += \"\\n\\n\" + WpcEditStore.exportAsDataArray(this.blendPlane());\n        }\n        let link = document.createElement(\"a\");\n        link.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(dataString);\n        const filename = \"plane\" + this.planeIndices.current + \".txt\";\n        link.download = filename;\n        link.style.display = \"none\";\n        document.body.appendChild(link);\n        link.click();\n        link.parentNode.removeChild(link);\n      } else if (this.exportOption == 1 || this.exportOption == 2) {\n        let inverted = false;\n        if (this.exportOption == 2) {\n          inverted = true;\n        }\n        let image = WpcEditStore.exportAs1bitBmp(this.mainPlane(), inverted);\n        let link = document.createElement(\"a\");\n        link.href = 'data:image/bmp;base64,' + image;\n        const filename = \"plane\" + this.planeIndices.current + \".bmp\";\n        link.download = filename;\n        link.style.display = \"none\";\n        document.body.appendChild(link);\n        link.click();\n        link.parentNode.removeChild(link);\n      }\n    }\n  },\n  updated() {\n    this.offset = 0;\n    this.setInitValues();\n  }\n};","map":{"version":3,"mappings":"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","names":["BaseModal","ModalHeader","ModalFooter","ExportSection","MainDmd","SubDmd","OffsetControl","toHex","store","useWpcEditStore","WpcEditStore","name","components","setup","data","options","Array","labels","i","length","selected","exportOption","push","value","label","doBlend","offset","blendOffset","xOffset0","yOffset0","xOffset1","yOffset1","props","show","Boolean","index","Number","table","computed","planeIndices","currIndex","Math","max","current","blend","currPlaneTitle","blendPlaneLabel","title","getSpriteAt","address","methods","plane0","indices","sprite","floor","width","height","getSpriteAsFullFrame","plane1","blendPlane","setBlendStatus","state","goToNextBlendPlane","goToPrevBlendPlane","goNext","setInitValues","goPrev","goN2","goP2","moveSprite0X","amount","moveSprite0Y","moveSprite1X","moveSprite1Y","exportCurrentSprite","$refs","main","downloadPng","dataString","exportAsDataArray","mainPlane","link","document","createElement","href","encodeURIComponent","filename","download","style","display","body","appendChild","click","parentNode","removeChild","inverted","image","exportAs1bitBmp","updated"],"sourceRoot":"","sources":["/Users/permartinson/Documents/GitHub/wpcedit-vue/src/components/ui/modals/SpriteModal.vue"],"sourcesContent":["<template>\n    <BaseModal :show=\"show\" @close=\"$emit('close')\">\n        <ModalHeader\n            :stepBtns=\"true\"\n            :closeBtn=\"true\"\n            :title=\"title\"\n            @next=\"goNext()\"\n            @prev=\"goPrev()\"\n            @next2=\"goN2()\"\n            @prev2=\"goP2()\"\n            @close=\"$emit('close')\">\n        </ModalHeader>\n        <div class=\"modal-body\">\n            <MainDmd :plane0=\"plane0()\" :plane1=\"plane1()\" :index=\"planeIndices.current\" ref=\"main\"></MainDmd>\n            <div class=\"sub-dmds\">\n                <div>\n                    <SubDmd\n                        class=\"plane plane0\"\n                        :title=\"this.currPlaneTitle\"\n                        :isEnabled=\"true\"\n                        :plane=\"plane0()\">\n                    </SubDmd>\n                    <OffsetControl\n                        @move-x=\"moveSprite0X\"\n                        @move-y=\"moveSprite0Y\"\n                        :xOffset=\"xOffset0\"\n                        :yOffset=\"yOffset0\">\n                    </OffsetControl>\n                </div>\n                <div>\n                    <SubDmd\n                        class=\"plane plane1\"\n                        :checkbox=\"this.blendPlaneLabel\"\n                        :plane=\"blendPlane()\"\n                        :isEnabled=\"this.doBlend\"\n                        :navBtns=\"true\"\n                        @next=\"goToNextBlendPlane()\"\n                        @prev=\"goToPrevBlendPlane()\"\n                        @enabled=\"setBlendStatus\">\n                    </SubDmd>\n                    <OffsetControl\n                        @move-x=\"moveSprite1X\"\n                        @move-y=\"moveSprite1Y\"\n                        :xOffset=\"xOffset1\"\n                        :yOffset=\"yOffset1\">\n                    </OffsetControl>\n                </div>\n            </div>\n        </div>\n        <ModalFooter>\n            <ExportSection @export=\"exportCurrentSprite\" :options=\"options\">\n            </ExportSection>\n        </ModalFooter>\n    </BaseModal>\n</template>\n\n<script>\nimport BaseModal from './BaseModal.vue';\nimport ModalHeader from './ModalHeader.vue';\nimport ModalFooter from './ModalFooter.vue';\nimport ExportSection from '../ExportSection.vue';\nimport MainDmd from '../../dmd/MainDmd.vue';\nimport SubDmd from '../../dmd/SubDmd.vue';\nimport OffsetControl from '../../ui/OffsetControl.vue';\nimport { toHex } from '../../../helpers/formatting.js';\nimport store from \"../../../stores/store.js\";\nimport { useWpcEditStore } from '../../../stores/wpcEditStore.js'\n\nconst WpcEditStore = useWpcEditStore(store);\n\nexport default {\n    name: 'SpriteModal',\n    components: { \n        BaseModal,\n        ModalHeader,\n        ModalFooter,\n        ExportSection,\n        MainDmd,\n        SubDmd,\n        OffsetControl\n    },\n    setup() {\n    },\n    data() {\n        // fetch the selected export option and create an object to pass the data for the selector\n        const options = new Array();\n        const labels = [\n            'PNG image from render',\n            'Monochrome BMP image',\n            'Monochrome BMP image (inverted)',\n            'Raw byte array, horizontal encoding'\n        ]\n        for(let i=0;i<labels.length;i++) {\n            const selected = (i == this.exportOption);\n            options.push({value:i,label:labels[i],selected:selected})\n        }\n\n        return {\n            doBlend: false,\n            offset: 0,\n            blendOffset: 1,\n            xOffset0: -1,\n            yOffset0: -1,\n            xOffset1: -1,\n            yOffset1: -1,\n            options\n        }\n    },\n    props: {\n        show: Boolean,\n        index: Number,\n        table: Number\n    },\n    computed: {\n        planeIndices() {\n            const currIndex = Math.max(this.index+this.offset,0); // BUG! need to use the map as a reference here\n            return {\n                current: currIndex,\n                blend: Math.max(currIndex+this.blendOffset,0),\n            }\n        },\n        currPlaneTitle() {\n            return `This sprite, index ${this.planeIndices.current}`;\n        },\n        blendPlaneLabel() {\n            return `Blend with index ${this.planeIndices.blend}`;\n        },\n        title() {\n            return `Image ${toHex(WpcEditStore.getSpriteAt(this.table,this.planeIndices.current).address,6)}`;\n        }\n    },\n    methods: {\n        plane0() {\n            const indices = this.planeIndices;\n            const sprite = WpcEditStore.getSpriteAt(this.table,indices.current);\n            if(this.xOffset0 == -1 && this.yOffset0 == -1) {\n                this.xOffset0 = Math.floor((128-sprite.width)/2);\n                this.yOffset0 = Math.floor((32-sprite.height)/2);\n            }\n            return WpcEditStore.getSpriteAsFullFrame(sprite,this.xOffset0,this.yOffset0);\n        },\n        plane1() {\n            if(this.doBlend) {\n                return this.blendPlane();\n            }\n            return this.plane0();\n        },\n        blendPlane() {\n            const indices = this.planeIndices;\n            const sprite = WpcEditStore.getSpriteAt(this.table,indices.blend);\n            if(this.xOffset1 == -1 && this.yOffset1 == -1) {\n                this.xOffset1 = Math.floor((128-sprite.width)/2);\n                this.yOffset1 = Math.floor((32-sprite.height)/2);\n            }\n            return WpcEditStore.getSpriteAsFullFrame(sprite,this.xOffset1,this.yOffset1);\n        },\n        setBlendStatus(state) {\n            if(state == true) {\n                this.doBlend = true;\n            } else if(state == false) {\n                this.doBlend = false;\n            }\n        },\n        goToNextBlendPlane() {\n            this.blendOffset++;\n        },\n        goToPrevBlendPlane() {\n            this.blendOffset--;\n        },\n        goNext() {\n            this.offset++;\n            this.setInitValues();\n        },\n        goPrev() {\n            if(this.planeIndices.current > 0) {\n                this.offset--;\n            }\n            this.setInitValues();\n        },\n        goN2() {\n            this.offset+=2;\n            this.setInitValues();\n        },\n        goP2() {\n            if(this.planeIndices.current > 0) {\n                this.offset-=2;\n            }\n            this.setInitValues();\n        },\n        moveSprite0X(amount) {\n            this.xOffset0 += amount;\n        },\n        moveSprite0Y(amount) {\n            this.yOffset0 += amount;\n        },\n        moveSprite1X(amount) {\n            this.xOffset1 += amount;\n        },\n        moveSprite1Y(amount) {\n            this.yOffset1 += amount;\n        },\n        setInitValues() {\n            // reset the values\n            this.blendOffset = 1;\n            this.xOffset0 = -1;\n            this.yOffset0 = -1;\n            this.xOffset1 = -1;\n            this.yOffset1 = -1;\n        },\n        exportCurrentSprite() {\n            if(this.exportOption == 0) {\n                this.$refs.main.downloadPng();\n            } else if(this.exportOption == 3) {\n                let dataString =  WpcEditStore.exportAsDataArray(this.mainPlane());\n                if(this.doBlend) {\n                    dataString += \"\\n\\n\"+ WpcEditStore.exportAsDataArray(this.blendPlane());\n                }\n                let link = document.createElement(\"a\");\n                link.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(dataString);\n                const filename = \"plane\"+this.planeIndices.current+\".txt\";\n                link.download = filename;\n                link.style.display = \"none\";\n                document.body.appendChild(link);\n                link.click();\n                link.parentNode.removeChild(link);\n            } else if(this.exportOption == 1 || this.exportOption == 2) {\n                let inverted = false;\n                if(this.exportOption == 2) {\n                    inverted = true;\n                }\n                let image = WpcEditStore.exportAs1bitBmp(this.mainPlane(),inverted);\n                let link = document.createElement(\"a\");\n                link.href = 'data:image/bmp;base64,' + image;\n                const filename = \"plane\"+this.planeIndices.current+\".bmp\";\n                link.download = filename;\n                link.style.display = \"none\";\n                document.body.appendChild(link);\n                link.click();\n                link.parentNode.removeChild(link);\n            }\n        }\n    },\n    updated() {\n        this.offset = 0;\n        this.setInitValues();\n    }\n}\n</script>\n\n<style scoped>\n.sub-dmds {\n    margin-top: var(--space-md);\n    display: grid;\n    gap: var(--space-md);\n    grid-template-columns: 1fr 1fr;\n}\n.plane {\n    justify-self: left;\n}\n.modal-body {\n    margin: 0 var(--space-md);\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}