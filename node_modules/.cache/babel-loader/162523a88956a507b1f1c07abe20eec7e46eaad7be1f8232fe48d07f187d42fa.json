{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { WPCEdit } from 'wpcedit';\nexport const useWpcEditStore = defineStore('wpcEditStore', {\n  state: () => {\n    return {\n      romIsLoaded: false,\n      viewTitle: 'WPC Edit',\n      isAtHomeView: true,\n      currSpriteIndex: 0,\n      currSpriteTableIndex: 0,\n      currentRomData: null\n    };\n  },\n  getters: {\n    maxFullFrameIndex: state => {\n      let index = 900; //WPCEdit.fullFrameImage.maxImageIndex;\n      let invalidImages = 0;\n      while (invalidImages < 4 && index < 2000) {\n        const plane = WPCEdit.fullFrameImage.getPlaneAt(index);\n        if (plane.type > 11 && plane.type != 255) {\n          invalidImages++;\n          console.log(\"INVALID at index: \" + index);\n        }\n        index++;\n      }\n\n      //console.log(\"type: \"+plane.type);\n\n      console.log(state);\n      console.log(\"max: \" + index);\n      return index;\n      //return 1000;\n    },\n\n    maxSpriteTable: () => {\n      return 64; //TEMP! Get value from ROM!\n    },\n\n    maxSpriteIndexInCurrentTable: () => {\n      return 1208; //TEMP! Get value from ROM!\n    }\n  },\n\n  actions: {\n    loadRom(data) {\n      WPCEdit.init();\n      WPCEdit.setRom(data);\n      if (WPCEdit.setRom(data)) {\n        this.romIsLoaded = true;\n        this.currentRomData = data;\n      }\n    },\n    getFullFrameImageAt(index) {\n      return WPCEdit.fullFrameImage.getPlaneAt(index);\n    },\n    getSpriteAt(table, index) {\n      WPCEdit.variableSizedImage.next(1);\n      console.log(table + \" \" + index);\n\n      /* implement a pattern like this in WPCEdit.js\n      /* ===========================================\n      const indexDelta = index - this.currSpriteIndex;\n      if(indexDelta < 0) {\n          WPCEdit.variableSizedImage.prev(Math.abs(indexDelta))\n      } else {\n          WPCEdit.variableSizedImage.next(indexDelta);\n      }\n      this.currSpriteIndex = index;\n      */\n\n      return WPCEdit.variableSizedImage.plane;\n    }\n  }\n});","map":{"version":3,"names":["defineStore","WPCEdit","useWpcEditStore","state","romIsLoaded","viewTitle","isAtHomeView","currSpriteIndex","currSpriteTableIndex","currentRomData","getters","maxFullFrameIndex","index","invalidImages","plane","fullFrameImage","getPlaneAt","type","console","log","maxSpriteTable","maxSpriteIndexInCurrentTable","actions","loadRom","data","init","setRom","getFullFrameImageAt","getSpriteAt","table","variableSizedImage","next"],"sources":["/Users/permartinson/Documents/GitHub/wpcedit-vue/src/stores/wpcEditStore.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { WPCEdit } from 'wpcedit';\n\nexport const useWpcEditStore = defineStore('wpcEditStore', {\n    state: () => {\n        return {\n            romIsLoaded: false,\n            viewTitle: 'WPC Edit',\n            isAtHomeView: true,\n            currSpriteIndex: 0,\n            currSpriteTableIndex: 0,\n            currentRomData: null\n        }\n    },\n    getters: {\n        maxFullFrameIndex: (state) => {\n            \n            let index = 900;//WPCEdit.fullFrameImage.maxImageIndex;\n            let invalidImages = 0;\n            while(invalidImages<4 && index<2000) {\n                const plane = WPCEdit.fullFrameImage.getPlaneAt(index);\n                if(plane.type > 11 && plane.type != 255) {\n                    invalidImages++;\n                    console.log(\"INVALID at index: \"+index);\n                }\n                index++;\n            }\n            \n            //console.log(\"type: \"+plane.type);\n    \n            console.log(state);\n            console.log(\"max: \"+index)\n            return index;\n            //return 1000;\n        },\n        maxSpriteTable: () => {\n            return 64; //TEMP! Get value from ROM!\n        },\n        maxSpriteIndexInCurrentTable: () => {\n            return 1208; //TEMP! Get value from ROM!\n        }\n    },\n    actions: {\n        loadRom(data) {\n            WPCEdit.init();\n            WPCEdit.setRom(data)\n            if(WPCEdit.setRom(data)) {\n                this.romIsLoaded = true;\n                this.currentRomData = data;    \n            }\n        },\n        getFullFrameImageAt(index) {\n            return WPCEdit.fullFrameImage.getPlaneAt(index);\n        },\n        getSpriteAt(table,index) {\n            WPCEdit.variableSizedImage.next(1);\n            console.log(table+ \" \"+index);\n\n            /* implement a pattern like this in WPCEdit.js\n            /* ===========================================\n            const indexDelta = index - this.currSpriteIndex;\n            if(indexDelta < 0) {\n                WPCEdit.variableSizedImage.prev(Math.abs(indexDelta))\n            } else {\n                WPCEdit.variableSizedImage.next(indexDelta);\n            }\n            this.currSpriteIndex = index;\n            */\n\n            return WPCEdit.variableSizedImage.plane;\n        }\n    }\n})"],"mappings":"AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,OAAO,QAAQ,SAAS;AAEjC,OAAO,MAAMC,eAAe,GAAGF,WAAW,CAAC,cAAc,EAAE;EACvDG,KAAK,EAAE,MAAM;IACT,OAAO;MACHC,WAAW,EAAE,KAAK;MAClBC,SAAS,EAAE,UAAU;MACrBC,YAAY,EAAE,IAAI;MAClBC,eAAe,EAAE,CAAC;MAClBC,oBAAoB,EAAE,CAAC;MACvBC,cAAc,EAAE;IACpB,CAAC;EACL,CAAC;EACDC,OAAO,EAAE;IACLC,iBAAiB,EAAGR,KAAK,IAAK;MAE1B,IAAIS,KAAK,GAAG,GAAG,CAAC;MAChB,IAAIC,aAAa,GAAG,CAAC;MACrB,OAAMA,aAAa,GAAC,CAAC,IAAID,KAAK,GAAC,IAAI,EAAE;QACjC,MAAME,KAAK,GAAGb,OAAO,CAACc,cAAc,CAACC,UAAU,CAACJ,KAAK,CAAC;QACtD,IAAGE,KAAK,CAACG,IAAI,GAAG,EAAE,IAAIH,KAAK,CAACG,IAAI,IAAI,GAAG,EAAE;UACrCJ,aAAa,EAAE;UACfK,OAAO,CAACC,GAAG,CAAC,oBAAoB,GAACP,KAAK,CAAC;QAC3C;QACAA,KAAK,EAAE;MACX;;MAEA;;MAEAM,OAAO,CAACC,GAAG,CAAChB,KAAK,CAAC;MAClBe,OAAO,CAACC,GAAG,CAAC,OAAO,GAACP,KAAK,CAAC;MAC1B,OAAOA,KAAK;MACZ;IACJ,CAAC;;IACDQ,cAAc,EAAE,MAAM;MAClB,OAAO,EAAE,CAAC,CAAC;IACf,CAAC;;IACDC,4BAA4B,EAAE,MAAM;MAChC,OAAO,IAAI,CAAC,CAAC;IACjB;EACJ,CAAC;;EACDC,OAAO,EAAE;IACLC,OAAO,CAACC,IAAI,EAAE;MACVvB,OAAO,CAACwB,IAAI,EAAE;MACdxB,OAAO,CAACyB,MAAM,CAACF,IAAI,CAAC;MACpB,IAAGvB,OAAO,CAACyB,MAAM,CAACF,IAAI,CAAC,EAAE;QACrB,IAAI,CAACpB,WAAW,GAAG,IAAI;QACvB,IAAI,CAACK,cAAc,GAAGe,IAAI;MAC9B;IACJ,CAAC;IACDG,mBAAmB,CAACf,KAAK,EAAE;MACvB,OAAOX,OAAO,CAACc,cAAc,CAACC,UAAU,CAACJ,KAAK,CAAC;IACnD,CAAC;IACDgB,WAAW,CAACC,KAAK,EAACjB,KAAK,EAAE;MACrBX,OAAO,CAAC6B,kBAAkB,CAACC,IAAI,CAAC,CAAC,CAAC;MAClCb,OAAO,CAACC,GAAG,CAACU,KAAK,GAAE,GAAG,GAACjB,KAAK,CAAC;;MAE7B;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;MAEY,OAAOX,OAAO,CAAC6B,kBAAkB,CAAChB,KAAK;IAC3C;EACJ;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}